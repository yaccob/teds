$schema: "https://json-schema.org/draft/2020-12/schema"
title: "Fleet Management System Schema"
type: object
examples:
  - vehicles:
      - vehicle_id: "550e8400-e29b-41d4-a716-446655440001"
        license_plate: "ABC-1234"
        vin: "1HGBH41JXMN109186"
        make: "Ford"
        model: "Transit"
        year: 2023
        vehicle_type: "van"
        fuel_type: "gasoline"
        mileage: 45820
        location:
          address: "123 Fleet Street"
          city: "San Francisco"
          state: "CA"
          postal_code: "94105"
          country: "United States"
          latitude: 37.7749
          longitude: -122.4194
        status: "available"
        assigned_driver_id: "550e8400-e29b-41d4-a716-446655440010"
        insurance:
          policy_number: "POL-FL-2024-001"
          provider: "Fleet Insurance Corp"
          coverage_type: "comprehensive"
          premium:
            amount: 1200.00
            currency: "USD"
          deductible:
            amount: 500.00
            currency: "USD"
          effective_date: "2024-01-01"
          expiration_date: "2024-12-31"
    drivers:
      - driver_id: "550e8400-e29b-41d4-a716-446655440010"
        employee_id: "EMP-2024-001"
        name:
          first_name: "Maria"
          last_name: "Rodriguez"
        email: "maria.rodriguez@fleetco.com"
        phone: "+15551234567"
        address:
          street: "456 Driver Lane"
          city: "Oakland"
          state: "California"
          postal_code: "94607"
          country: "United States"
        license:
          license_number: "D1234567"
          license_class: "B"
          issue_date: "2020-03-15"
          expiration_date: "2028-03-15"
          issuing_state: "CA"
          restrictions: []
        hire_date: "2022-06-01"
        status: "active"
        certifications: ["Defensive Driving", "Commercial Vehicle Safety"]
    routes:
      - route_id: "550e8400-e29b-41d4-a716-446655440020"
        name: "Downtown Delivery Route"
        vehicle_id: "550e8400-e29b-41d4-a716-446655440001"
        driver_id: "550e8400-e29b-41d4-a716-446655440010"
        start_location:
          address: "123 Fleet Street"
          city: "San Francisco"
          state: "CA"
          postal_code: "94105"
          country: "United States"
          latitude: 37.7749
          longitude: -122.4194
        end_location:
          address: "789 Customer Ave"
          city: "San Francisco"
          state: "CA"
          postal_code: "94102"
          country: "United States"
          latitude: 37.7849
          longitude: -122.4094
        waypoints:
          - address: "456 Waypoint St"
            city: "San Francisco"
            state: "CA"
            postal_code: "94103"
            country: "United States"
            latitude: 37.7799
            longitude: -122.4144
        estimated_duration_minutes: 45
        estimated_distance_miles: 12.5
        scheduled_start: "2024-10-01T09:00:00Z"
        actual_start: "2024-10-01T09:05:00Z"
        actual_end: "2024-10-01T09:52:00Z"
        status: "completed"
    maintenance:
      - maintenance_id: "550e8400-e29b-41d4-a716-446655440030"
        vehicle_id: "550e8400-e29b-41d4-a716-446655440001"
        maintenance_type: "routine"
        description: "Regular oil change and 20-point inspection"
        scheduled_date: "2024-09-15"
        completed_date: "2024-09-15"
        cost:
          amount: 89.95
          currency: "USD"
        service_provider: "Quick Lube Express"
        mileage_at_service: 45000
        next_service_due: "2024-12-15"
        status: "completed"
        parts_replaced:
          - part_number: "OF-5W30-5QT"
            description: "5W-30 Motor Oil, 5 Quarts"
            quantity: 1
            cost_per_unit:
              amount: 24.99
              currency: "USD"
            supplier: "AutoParts Plus"
          - part_number: "OF-FILTER-A123"
            description: "Oil Filter"
            quantity: 1
            cost_per_unit:
              amount: 12.99
              currency: "USD"
            supplier: "AutoParts Plus"
properties:
  vehicles:
    type: array
    items:
      $ref: "#/$defs/Vehicle"
  drivers:
    type: array
    items:
      $ref: "#/$defs/Driver"
  routes:
    type: array
    items:
      $ref: "#/$defs/Route"
  maintenance:
    type: array
    items:
      $ref: "#/$defs/MaintenanceRecord"
$defs:
  Vehicle:
    type: object
    properties:
      vehicle_id:
        type: string
        format: uuid
      license_plate:
        type: string
      vin:
        type: string
        pattern: "^[A-HJ-NPR-Z0-9]{17}$"
      make:
        type: string
      model:
        type: string
      year:
        type: integer
        minimum: 1990
        maximum: 2030
      vehicle_type:
        type: string
        enum: ["sedan", "suv", "truck", "van", "motorcycle", "bus"]
      fuel_type:
        type: string
        enum: ["gasoline", "diesel", "electric", "hybrid", "natural_gas"]
      mileage:
        type: integer
        minimum: 0
      location:
        $ref: "../logistics_shipping/logistics.yaml#/$defs/Location"
      status:
        type: string
        enum: ["available", "in_use", "maintenance", "out_of_service"]
      assigned_driver_id:
        type: string
        format: uuid
      insurance:
        $ref: "#/$defs/Insurance"
    required: ["vehicle_id", "license_plate", "vin", "make", "model", "year", "vehicle_type", "fuel_type", "status"]
  Driver:
    type: object
    properties:
      driver_id:
        type: string
        format: uuid
      employee_id:
        type: string
      name:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/PersonName"
      email:
        type: string
        format: email
      phone:
        type: string
        pattern: "^\\+?[1-9]\\d{1,14}$"
      address:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Address"
      license:
        $ref: "#/$defs/DriversLicense"
      hire_date:
        type: string
        format: date
      status:
        type: string
        enum: ["active", "suspended", "terminated", "on_leave"]
      certifications:
        type: array
        items:
          type: string
    required: ["driver_id", "employee_id", "name", "email", "phone", "license", "hire_date", "status"]
  DriversLicense:
    type: object
    properties:
      license_number:
        type: string
      license_class:
        type: string
        enum: ["A", "B", "C", "CDL-A", "CDL-B", "CDL-C", "motorcycle"]
      issue_date:
        type: string
        format: date
      expiration_date:
        type: string
        format: date
      issuing_state:
        type: string
        pattern: "^[A-Z]{2}$"
      restrictions:
        type: array
        items:
          type: string
    required: ["license_number", "license_class", "issue_date", "expiration_date", "issuing_state"]
  Route:
    type: object
    properties:
      route_id:
        type: string
        format: uuid
      name:
        type: string
        maxLength: 100
      vehicle_id:
        type: string
        format: uuid
      driver_id:
        type: string
        format: uuid
      start_location:
        $ref: "../logistics_shipping/logistics.yaml#/$defs/Location"
      end_location:
        $ref: "../logistics_shipping/logistics.yaml#/$defs/Location"
      waypoints:
        type: array
        items:
          $ref: "../logistics_shipping/logistics.yaml#/$defs/Location"
      estimated_duration_minutes:
        type: integer
        minimum: 1
      estimated_distance_miles:
        type: number
        minimum: 0.1
      scheduled_start:
        type: string
        format: date-time
      actual_start:
        type: string
        format: date-time
      actual_end:
        type: string
        format: date-time
      status:
        type: string
        enum: ["scheduled", "in_progress", "completed", "cancelled", "delayed"]
    required: ["route_id", "name", "start_location", "end_location", "estimated_duration_minutes", "scheduled_start", "status"]
  MaintenanceRecord:
    type: object
    properties:
      maintenance_id:
        type: string
        format: uuid
      vehicle_id:
        type: string
        format: uuid
      maintenance_type:
        type: string
        enum: ["routine", "repair", "inspection", "recall", "emergency"]
      description:
        type: string
        maxLength: 1000
      scheduled_date:
        type: string
        format: date
      completed_date:
        type: string
        format: date
      cost:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      service_provider:
        type: string
        maxLength: 100
      mileage_at_service:
        type: integer
        minimum: 0
      next_service_due:
        type: string
        format: date
      status:
        type: string
        enum: ["scheduled", "in_progress", "completed", "cancelled"]
      parts_replaced:
        type: array
        items:
          $ref: "#/$defs/Part"
    required: ["maintenance_id", "vehicle_id", "maintenance_type", "description", "scheduled_date", "status"]
  Part:
    type: object
    properties:
      part_number:
        type: string
      description:
        type: string
      quantity:
        type: integer
        minimum: 1
      cost_per_unit:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      supplier:
        type: string
    required: ["part_number", "description", "quantity", "cost_per_unit"]
  Insurance:
    type: object
    properties:
      policy_number:
        type: string
      provider:
        type: string
      coverage_type:
        type: string
        enum: ["liability", "comprehensive", "collision", "full"]
      premium:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      deductible:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      effective_date:
        type: string
        format: date
      expiration_date:
        type: string
        format: date
    required: ["policy_number", "provider", "coverage_type", "effective_date", "expiration_date"]
