$schema: "https://json-schema.org/draft/2020-12/schema"
title: "Ride Sharing Platform Schema"
type: object
properties:
  riders:
    type: array
    items:
      $ref: "#/$defs/Rider"
  drivers:
    type: array
    items:
      $ref: "#/$defs/Driver"
  rides:
    type: array
    items:
      $ref: "#/$defs/Ride"
  vehicles:
    type: array
    items:
      $ref: "../fleet_management/fleet_management.yaml#/$defs/Vehicle"
examples:
  - riders:
      - rider_id: "550e8400-e29b-41d4-a716-446655440000"
        name:
          first: "John"
          last: "Doe"
        email: "john@example.com"
        phone: "+1234567890"
    drivers:
      - driver_id: "6ba7b810-9dad-11d1-80b4-00c04fd430c8"
        name:
          first: "Jane"
          last: "Smith"
        email: "jane@example.com"
        phone: "+1987654321"
        license:
          license_number: "D123456789"
          state: "CA"
          expiry_date: "2025-12-31"
        status: "online"
    rides:
      - ride_id: "123e4567-e89b-12d3-a456-426614174000"
        rider_id: "550e8400-e29b-41d4-a716-446655440000"
        pickup_location:
          latitude: 37.7749
          longitude: -122.4194
          address: "123 Main St, San Francisco, CA"
        dropoff_location:
          latitude: 37.7849
          longitude: -122.4094
          address: "456 Oak St, San Francisco, CA"
        requested_time: "2024-01-15T14:30:00Z"
        status: "requested"
        ride_type: "economy"
    vehicles:
      - vehicle_id: "987fcdeb-51a2-43d8-b123-456789abcdef"
        make: "Toyota"
        model: "Prius"
        year: 2022
        license_plate: "ABC123"
        status: "active"
$defs:
  Rider:
    type: object
    properties:
      rider_id:
        type: string
        format: uuid
      name:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/PersonName"
      email:
        type: string
        format: email
      phone:
        type: string
        pattern: "^\\+?[1-9]\\d{1,14}$"
      rating:
        type: number
        minimum: 1
        maximum: 5
      total_rides:
        type: integer
        minimum: 0
      payment_methods:
        type: array
        items:
          $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Payment"
      preferences:
        $ref: "#/$defs/RiderPreferences"
    required: ["rider_id", "name", "email", "phone"]
  RiderPreferences:
    type: object
    properties:
      preferred_car_type:
        type: string
        enum: ["economy", "comfort", "premium", "suv", "any"]
      music_preference:
        type: string
        enum: ["no_music", "driver_choice", "my_playlist"]
      temperature_preference:
        type: string
        enum: ["warm", "cool", "driver_choice"]
      conversation_preference:
        type: string
        enum: ["chatty", "quiet", "no_preference"]
  Driver:
    type: object
    properties:
      driver_id:
        type: string
        format: uuid
      name:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/PersonName"
      email:
        type: string
        format: email
      phone:
        type: string
        pattern: "^\\+?[1-9]\\d{1,14}$"
      license:
        $ref: "../fleet_management/fleet_management.yaml#/$defs/DriversLicense"
      rating:
        type: number
        minimum: 1
        maximum: 5
      total_rides:
        type: integer
        minimum: 0
      status:
        type: string
        enum: ["online", "offline", "busy", "inactive"]
      vehicle_id:
        type: string
        format: uuid
      current_location:
        $ref: "../logistics_shipping/logistics.yaml#/$defs/Location"
      earnings:
        $ref: "#/$defs/DriverEarnings"
    required: ["driver_id", "name", "email", "phone", "license", "status"]
  DriverEarnings:
    type: object
    properties:
      total_earnings:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      weekly_earnings:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      monthly_earnings:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      last_payout:
        type: string
        format: date
  Ride:
    type: object
    properties:
      ride_id:
        type: string
        format: uuid
      rider_id:
        type: string
        format: uuid
      driver_id:
        type: string
        format: uuid
      pickup_location:
        $ref: "../logistics_shipping/logistics.yaml#/$defs/Location"
      dropoff_location:
        $ref: "../logistics_shipping/logistics.yaml#/$defs/Location"
      requested_time:
        type: string
        format: date-time
      pickup_time:
        type: string
        format: date-time
      dropoff_time:
        type: string
        format: date-time
      status:
        type: string
        enum: ["requested", "accepted", "driver_arriving", "in_progress", "completed", "cancelled"]
      ride_type:
        type: string
        enum: ["economy", "comfort", "premium", "suv", "shared"]
      estimated_duration:
        type: integer
        minimum: 1
      actual_duration:
        type: integer
        minimum: 1
      estimated_distance:
        type: number
        minimum: 0.1
      actual_distance:
        type: number
        minimum: 0.1
      base_fare:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      surge_multiplier:
        type: number
        minimum: 1
        maximum: 5
      total_fare:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      tip:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      payment:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Payment"
      rider_rating:
        type: integer
        minimum: 1
        maximum: 5
      driver_rating:
        type: integer
        minimum: 1
        maximum: 5
    required: ["ride_id", "rider_id", "pickup_location", "dropoff_location", "requested_time", "status", "ride_type"]
