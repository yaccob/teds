$schema: "https://json-schema.org/draft/2020-12/schema"
title: "Restaurant Point of Sale Schema"
type: object
properties:
  menu_items:
    type: array
    items:
      $ref: "#/$defs/MenuItem"
  orders:
    type: array
    items:
      $ref: "#/$defs/Order"
  tables:
    type: array
    items:
      $ref: "#/$defs/Table"
  staff:
    type: array
    items:
      $ref: "#/$defs/Staff"
$defs:
  MenuItem:
    type: object
    properties:
      item_id:
        type: string
        format: uuid
      name:
        type: string
        maxLength: 100
      description:
        type: string
        maxLength: 500
      category:
        type: string
        enum: ["appetizer", "entree", "dessert", "beverage", "side"]
      price:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      cost:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      ingredients:
        type: array
        items:
          type: string
      allergens:
        type: array
        items:
          type: string
          enum: ["gluten", "dairy", "nuts", "soy", "eggs", "shellfish", "fish"]
      available:
        type: boolean
        default: true
      preparation_time:
        type: integer
        minimum: 1
      calories:
        type: integer
        minimum: 0
    required: ["item_id", "name", "category", "price", "available"]
  Order:
    type: object
    properties:
      order_id:
        type: string
        format: uuid
      order_number:
        type: integer
        minimum: 1
      table_id:
        type: string
        format: uuid
      server_id:
        type: string
        format: uuid
      items:
        type: array
        items:
          $ref: "#/$defs/OrderItem"
        minItems: 1
      subtotal:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      tax_amount:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      tip_amount:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      total_amount:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      payment_method:
        type: string
        enum: ["cash", "credit_card", "debit_card", "mobile_pay"]
      status:
        type: string
        enum: ["pending", "preparing", "ready", "served", "paid", "cancelled"]
      order_time:
        type: string
        format: date-time
      ready_time:
        type: string
        format: date-time
      special_instructions:
        type: string
        maxLength: 200
    required: ["order_id", "order_number", "table_id", "server_id", "items", "total_amount", "status", "order_time"]
  OrderItem:
    type: object
    properties:
      item_id:
        type: string
        format: uuid
      quantity:
        type: integer
        minimum: 1
      unit_price:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      total_price:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      modifications:
        type: array
        items:
          type: string
      status:
        type: string
        enum: ["ordered", "preparing", "ready", "served"]
    required: ["item_id", "quantity", "unit_price", "total_price", "status"]
  Table:
    type: object
    properties:
      table_id:
        type: string
        format: uuid
      table_number:
        type: integer
        minimum: 1
      capacity:
        type: integer
        minimum: 1
        maximum: 20
      location:
        type: string
        enum: ["dining_room", "patio", "bar", "private_room"]
      status:
        type: string
        enum: ["available", "occupied", "reserved", "cleaning"]
      current_order_id:
        type: string
        format: uuid
    required: ["table_id", "table_number", "capacity", "location", "status"]
  Staff:
    type: object
    properties:
      staff_id:
        type: string
        format: uuid
      employee_id:
        type: string
      name:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/PersonName"
      role:
        type: string
        enum: ["server", "cook", "manager", "host", "bartender", "busser"]
      hourly_rate:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      hire_date:
        type: string
        format: date
      status:
        type: string
        enum: ["active", "inactive", "terminated"]
      shift:
        $ref: "#/$defs/Shift"
    required: ["staff_id", "employee_id", "name", "role", "hourly_rate", "hire_date", "status"]
  Shift:
    type: object
    properties:
      start_time:
        type: string
        pattern: "^([01]?[0-9]|2[0-3]):[0-5][0-9]$"
      end_time:
        type: string
        pattern: "^([01]?[0-9]|2[0-3]):[0-5][0-9]$"
      days:
        type: array
        items:
          type: string
          enum: ["monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday"]
    required: ["start_time", "end_time", "days"]
