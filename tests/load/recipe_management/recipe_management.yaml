$schema: "https://json-schema.org/draft/2020-12/schema"
title: "Recipe Management Platform Schema"
type: object
properties:
  recipes:
    type: array
    items:
      $ref: "#/$defs/Recipe"
  ingredients:
    type: array
    items:
      $ref: "#/$defs/Ingredient"
  meal_plans:
    type: array
    items:
      $ref: "#/$defs/MealPlan"
  users:
    type: array
    items:
      $ref: "#/$defs/User"
$defs:
  Recipe:
    type: object
    examples:
      - recipe_id: "550e8400-e29b-41d4-a716-446655440001"
        title: "Classic Spaghetti Carbonara"
        description: "Traditional Italian pasta dish with eggs, cheese, and pancetta"
        author_id: "550e8400-e29b-41d4-a716-446655440010"
        cuisine_type: "italian"
        difficulty: "medium"
        prep_time_minutes: 15
        cook_time_minutes: 20
        total_time_minutes: 35
        servings: 4
        ingredients:
          - ingredient_id: "550e8400-e29b-41d4-a716-446655440020"
            quantity: 400
            unit: "gram"
            preparation: "cooked al dente"
          - ingredient_id: "550e8400-e29b-41d4-a716-446655440021"
            quantity: 4
            unit: "piece"
            preparation: "large, room temperature"
        instructions:
          - step_number: 1
            description: "Bring a large pot of salted water to boil and cook spaghetti until al dente"
            duration_minutes: 12
          - step_number: 2
            description: "In a large bowl, whisk together eggs and grated cheese"
            duration_minutes: 3
        nutrition:
          calories: 520
          protein_g: 22.5
          carbs_g: 65.0
          fat_g: 18.5
          fiber_g: 3.2
          sodium_mg: 680
        tags: ["quick", "italian"]
        rating: 4.7
        review_count: 156
        created_date: "2024-01-15T10:30:00Z"
    properties:
      recipe_id:
        type: string
        format: uuid
      title:
        type: string
        maxLength: 100
      description:
        type: string
        maxLength: 500
      author_id:
        type: string
        format: uuid
      cuisine_type:
        type: string
        enum: ["italian", "chinese", "mexican", "indian", "french", "japanese", "mediterranean", "american", "thai", "greek"]
      difficulty:
        type: string
        enum: ["easy", "medium", "hard"]
      prep_time_minutes:
        type: integer
        minimum: 1
      cook_time_minutes:
        type: integer
        minimum: 1
      total_time_minutes:
        type: integer
        minimum: 1
      servings:
        type: integer
        minimum: 1
      ingredients:
        type: array
        items:
          $ref: "#/$defs/RecipeIngredient"
        minItems: 1
      instructions:
        type: array
        items:
          $ref: "#/$defs/Instruction"
        minItems: 1
      nutrition:
        $ref: "#/$defs/NutritionInfo"
      tags:
        type: array
        items:
          type: string
          enum: ["vegetarian", "vegan", "gluten_free", "dairy_free", "keto", "paleo", "low_carb", "high_protein", "quick", "budget_friendly"]
      images:
        type: array
        items:
          type: string
          format: uri
      rating:
        type: number
        minimum: 0
        maximum: 5
      review_count:
        type: integer
        minimum: 0
      created_date:
        type: string
        format: date-time
    required: ["recipe_id", "title", "author_id", "prep_time_minutes", "cook_time_minutes", "servings", "ingredients", "instructions"]
  Ingredient:
    type: object
    examples:
      - ingredient_id: "550e8400-e29b-41d4-a716-446655440020"
        name: "Spaghetti"
        category: "grains"
        default_unit: "gram"
        nutrition_per_100g:
          calories: 371
          protein_g: 13.0
          carbs_g: 74.0
          fat_g: 1.5
          fiber_g: 3.2
          sodium_mg: 6
        allergens: ["gluten"]
    properties:
      ingredient_id:
        type: string
        format: uuid
      name:
        type: string
        maxLength: 100
      category:
        type: string
        enum: ["protein", "vegetables", "fruits", "grains", "dairy", "spices", "condiments", "oils", "nuts", "herbs"]
      default_unit:
        type: string
        enum: ["cup", "tablespoon", "teaspoon", "gram", "kilogram", "ounce", "pound", "liter", "milliliter", "piece"]
      nutrition_per_100g:
        $ref: "#/$defs/NutritionInfo"
      allergens:
        type: array
        items:
          type: string
          enum: ["gluten", "dairy", "nuts", "soy", "eggs", "shellfish", "fish"]
    required: ["ingredient_id", "name", "category", "default_unit"]
  RecipeIngredient:
    type: object
    properties:
      ingredient_id:
        type: string
        format: uuid
      quantity:
        type: number
        minimum: 0
      unit:
        type: string
        enum: ["cup", "tablespoon", "teaspoon", "gram", "kilogram", "ounce", "pound", "liter", "milliliter", "piece", "pinch", "dash"]
      preparation:
        type: string
        maxLength: 100
      optional:
        type: boolean
        default: false
    required: ["ingredient_id", "quantity", "unit"]
  Instruction:
    type: object
    properties:
      step_number:
        type: integer
        minimum: 1
      description:
        type: string
        maxLength: 1000
      duration_minutes:
        type: integer
        minimum: 0
      temperature:
        type: object
        properties:
          celsius:
            type: integer
          fahrenheit:
            type: integer
      image_url:
        type: string
        format: uri
    required: ["step_number", "description"]
  NutritionInfo:
    type: object
    properties:
      calories:
        type: integer
        minimum: 0
      protein_g:
        type: number
        minimum: 0
      carbs_g:
        type: number
        minimum: 0
      fat_g:
        type: number
        minimum: 0
      fiber_g:
        type: number
        minimum: 0
      sugar_g:
        type: number
        minimum: 0
      sodium_mg:
        type: number
        minimum: 0
      cholesterol_mg:
        type: number
        minimum: 0
  User:
    type: object
    examples:
      - user_id: "550e8400-e29b-41d4-a716-446655440010"
        username: "chef_maria"
        email: "maria.rossi@email.com"
        name:
          first_name: "Maria"
          last_name: "Rossi"
        dietary_restrictions: ["vegetarian"]
        favorite_cuisines: ["italian", "mediterranean"]
        cooking_skill: "advanced"
        favorite_recipes: ["550e8400-e29b-41d4-a716-446655440001"]
        created_recipes: ["550e8400-e29b-41d4-a716-446655440001"]
    properties:
      user_id:
        type: string
        format: uuid
      username:
        type: string
        pattern: "^[a-zA-Z0-9_]{3,20}$"
      email:
        type: string
        format: email
      name:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/PersonName"
      dietary_restrictions:
        type: array
        items:
          type: string
          enum: ["vegetarian", "vegan", "gluten_free", "dairy_free", "nut_free", "keto", "paleo"]
      favorite_cuisines:
        type: array
        items:
          type: string
          enum: ["italian", "chinese", "mexican", "indian", "french", "japanese", "mediterranean", "american", "thai", "greek"]
      cooking_skill:
        type: string
        enum: ["beginner", "intermediate", "advanced"]
      favorite_recipes:
        type: array
        items:
          type: string
          format: uuid
      created_recipes:
        type: array
        items:
          type: string
          format: uuid
    required: ["user_id", "username", "email", "name", "cooking_skill"]
  MealPlan:
    type: object
    properties:
      meal_plan_id:
        type: string
        format: uuid
      user_id:
        type: string
        format: uuid
      name:
        type: string
        maxLength: 100
      start_date:
        type: string
        format: date
      end_date:
        type: string
        format: date
      meals:
        type: array
        items:
          $ref: "#/$defs/PlannedMeal"
      total_calories:
        type: integer
        minimum: 0
      shopping_list:
        type: array
        items:
          $ref: "#/$defs/ShoppingItem"
    required: ["meal_plan_id", "user_id", "name", "start_date", "end_date", "meals"]
  PlannedMeal:
    type: object
    properties:
      date:
        type: string
        format: date
      meal_type:
        type: string
        enum: ["breakfast", "lunch", "dinner", "snack"]
      recipe_id:
        type: string
        format: uuid
      servings:
        type: integer
        minimum: 1
    required: ["date", "meal_type", "recipe_id", "servings"]
  ShoppingItem:
    type: object
    properties:
      ingredient_id:
        type: string
        format: uuid
      quantity:
        type: number
        minimum: 0
      unit:
        type: string
      purchased:
        type: boolean
        default: false
    required: ["ingredient_id", "quantity", "unit"]
