$schema: "https://json-schema.org/draft/2020-12/schema"
title: "Manufacturing Operations Schema"
type: object
examples:
  - products:
      - product_id: "550e8400-e29b-41d4-a716-446655440001"
        part_number: "ENG-BLOCK-V8"
        name: "V8 Engine Block"
        description: "Cast iron engine block for 5.0L V8 engine with precision machined cylinder bores"
        category: "component"
        specifications:
          material: "Cast Iron"
          tolerance: "±0.05mm"
          surface_finish: "Ra 1.6"
          hardness: "HRC 45-50"
          operating_temperature:
            minimum: -40.0
            maximum: 150.0
        bill_of_materials:
          - item_id: "550e8400-e29b-41d4-a716-446655440010"
            part_number: "CI-INGOT-001"
            description: "Cast Iron Ingot"
            quantity: 25.0
            unit: "kg"
            cost_per_unit:
              amount: 2.50
              currency: "USD"
        cost:
          amount: 850.00
          currency: "USD"
        weight:
          value: 85.5
          unit: "kg"
        dimensions:
          length: 60.0
          width: 45.0
          height: 35.0
          unit: "cm"
    production_orders:
      - order_id: "550e8400-e29b-41d4-a716-446655440020"
        order_number: "PO-2024-001234"
        product_id: "550e8400-e29b-41d4-a716-446655440001"
        quantity: 100
        priority: "high"
        status: "in_progress"
        planned_start_date: "2024-10-01"
        planned_end_date: "2024-10-15"
        actual_start_date: "2024-10-01"
        assigned_line: "Line A"
        machine_ids: ["550e8400-e29b-41d4-a716-446655440030"]
        operator_id: "OP-001"
        progress_percentage: 65.0
        units_completed: 65
        estimated_completion: "2024-10-14T16:30:00Z"
    machines:
      - machine_id: "550e8400-e29b-41d4-a716-446655440030"
        machine_code: "CNC-001"
        name: "Haas VF-4 CNC Machining Center"
        type: "cnc_machine"
        manufacturer: "Haas Automation"
        model: "VF-4"
        year_installed: 2020
        status: "operational"
        location:
          building: "Manufacturing Plant A"
          floor: "1"
          cell: "C-03"
        specifications:
          max_spindle_speed: 8100
          spindle_taper: "40-Taper"
          table_size: "1270x510mm"
          axis_travel: "1270x510x635mm"
          tool_capacity: 20
        maintenance_schedule:
          last_service: "2024-09-01"
          next_service: "2024-12-01"
          service_interval_days: 90
        operating_hours: 2450.5
        efficiency_rating: 0.92
    quality_checks:
      - check_id: "550e8400-e29b-41d4-a716-446655440040"
        product_id: "550e8400-e29b-41d4-a716-446655440001"
        production_order_id: "550e8400-e29b-41d4-a716-446655440020"
        check_type: "dimensional"
        inspector_id: "QC-001"
        check_date: "2024-10-05T14:30:00Z"
        status: "passed"
        measurements:
          - parameter: "Cylinder Bore Diameter"
            specification: "86.00mm ±0.05mm"
            measured_value: 86.02
            unit: "mm"
            within_tolerance: true
          - parameter: "Surface Roughness"
            specification: "Ra 1.6 max"
            measured_value: 1.4
            unit: "Ra"
            within_tolerance: true
        defects_found: []
        corrective_actions: []
        passed: true
        notes: "All measurements within specification. Quality approved for next production stage."
properties:
  products:
    type: array
    items:
      $ref: "#/$defs/Product"
  production_orders:
    type: array
    items:
      $ref: "#/$defs/ProductionOrder"
  machines:
    type: array
    items:
      $ref: "#/$defs/Machine"
  quality_checks:
    type: array
    items:
      $ref: "#/$defs/QualityCheck"
$defs:
  Product:
    type: object
    properties:
      product_id:
        type: string
        format: uuid
      part_number:
        type: string
        pattern: "^[A-Z0-9-]{8,15}$"
      name:
        type: string
        maxLength: 100
      description:
        type: string
        maxLength: 500
      category:
        type: string
        enum: ["raw_material", "component", "sub_assembly", "finished_good"]
      specifications:
        $ref: "#/$defs/ProductSpecifications"
      bill_of_materials:
        type: array
        items:
          $ref: "#/$defs/BOMItem"
      cost:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
      weight:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Weight"
      dimensions:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Dimensions"
    required: ["product_id", "part_number", "name", "category", "specifications"]
  ProductSpecifications:
    type: object
    properties:
      material:
        type: string
      color:
        type: string
      finish:
        type: string
        enum: ["raw", "painted", "anodized", "plated", "powder_coated"]
      tolerance:
        type: string
      hardness:
        type: string
      temperature_range:
        $ref: "#/$defs/TemperatureRange"
    required: ["material"]
  TemperatureRange:
    type: object
    properties:
      min_celsius:
        type: number
      max_celsius:
        type: number
    required: ["min_celsius", "max_celsius"]
  BOMItem:
    type: object
    properties:
      component_id:
        type: string
        format: uuid
      quantity:
        type: number
        minimum: 0
      unit:
        type: string
        enum: ["each", "kg", "g", "m", "cm", "mm", "l", "ml"]
      cost_per_unit:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Money"
    required: ["component_id", "quantity", "unit"]
  ProductionOrder:
    type: object
    properties:
      order_id:
        type: string
        format: uuid
      order_number:
        type: string
        pattern: "^PO-[0-9]{6}$"
      product_id:
        type: string
        format: uuid
      quantity_ordered:
        type: integer
        minimum: 1
      quantity_produced:
        type: integer
        minimum: 0
      priority:
        type: string
        enum: ["low", "normal", "high", "urgent"]
      start_date:
        type: string
        format: date
      due_date:
        type: string
        format: date
      completion_date:
        type: string
        format: date
      status:
        type: string
        enum: ["planned", "in_progress", "completed", "cancelled", "on_hold"]
      assigned_machines:
        type: array
        items:
          type: string
          format: uuid
      operator_id:
        type: string
        format: uuid
    required: ["order_id", "order_number", "product_id", "quantity_ordered", "priority", "start_date", "due_date", "status"]
  Machine:
    type: object
    properties:
      machine_id:
        type: string
        format: uuid
      name:
        type: string
        maxLength: 100
      model:
        type: string
      manufacturer:
        type: string
      serial_number:
        type: string
      machine_type:
        type: string
        enum: ["cnc_mill", "cnc_lathe", "press", "welder", "grinder", "drill", "saw", "3d_printer"]
      location:
        $ref: "#/$defs/MachineLocation"
      capacity:
        $ref: "#/$defs/MachineCapacity"
      status:
        type: string
        enum: ["operational", "maintenance", "down", "setup"]
      last_maintenance:
        type: string
        format: date
      next_maintenance:
        type: string
        format: date
      operating_hours:
        type: number
        minimum: 0
    required: ["machine_id", "name", "model", "manufacturer", "machine_type", "location", "status"]
  MachineLocation:
    type: object
    properties:
      building:
        type: string
      floor:
        type: integer
        minimum: 1
      area:
        type: string
      workstation:
        type: string
    required: ["building", "floor", "area"]
  MachineCapacity:
    type: object
    properties:
      max_weight:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Weight"
      max_dimensions:
        $ref: "../ecommerce_platform/ecommerce.yaml#/$defs/Dimensions"
      power_consumption_kw:
        type: number
        minimum: 0
      units_per_hour:
        type: integer
        minimum: 1
  QualityCheck:
    type: object
    properties:
      check_id:
        type: string
        format: uuid
      production_order_id:
        type: string
        format: uuid
      inspector_id:
        type: string
        format: uuid
      check_type:
        type: string
        enum: ["incoming", "in_process", "final", "random"]
      check_date:
        type: string
        format: date-time
      measurements:
        type: array
        items:
          $ref: "#/$defs/Measurement"
      overall_result:
        type: string
        enum: ["pass", "fail", "conditional"]
      notes:
        type: string
        maxLength: 1000
    required: ["check_id", "production_order_id", "inspector_id", "check_type", "check_date", "overall_result"]
  Measurement:
    type: object
    properties:
      parameter:
        type: string
      measured_value:
        type: number
      target_value:
        type: number
      tolerance:
        type: number
      unit:
        type: string
      result:
        type: string
        enum: ["pass", "fail"]
    required: ["parameter", "measured_value", "target_value", "tolerance", "unit", "result"]
